<h1>Register with Spotify! <i class="fa-brands fa-spotify"></i></h1>
<div class="buttons" *ngIf="displayedUser == null">
    <button routerLink="/register">
      <span>Go to Register ></span>
    </button>
</div>

<h2 *ngIf="displayedUser != null">These are the infos we gathered from your Spotify account, however we will need a couple of more below.</h2>
<hr *ngIf="displayedUser != null"> 
<div class="card" *ngIf="displayedUser != null">
    <h5 class="card-header">
        <img src="{{displayedUser.photoUrl || './assets/user2.png'}}">
        @{{displayedUser.username}}
    </h5>
    <div class="card-body">
      <h5 class="card-title">{{displayedUser.country}}</h5>
      <p class="card-text">{{displayedUser.email}}</p>
    </div>

<div>
    
</div>
<div class="card">
    <form *ngIf="(accountService.currentUser$ | async) === null" [formGroup]="registerForm" autocomplete="off">
        <input formControlName="country" id="country" type="hidden" value="{{displayedUser.country}}"/>
        <input formControlName="email" type="hidden" value="{{displayedUser.email}}"/>
        <input id="username" formControlName="username" type="hidden" value="{{displayedUser.username}}"/>
            <div>
                <label for="firstname">First Name</label>
                <input type="text" 
                    formControlName="firstName" 
                    class="form-control me-2"  
                    placeholder="First Name"
                    [class.is-invalid]="registerForm.get('firstName')?.errors && registerForm.get('firstName')?.touched">
                <div class="invalid-feedback">Your first name must and be 1-50 characters long.</div>
            </div>

            <div>
                <label for="lastname">Last Name</label>
                <input type="text" 
                    formControlName="lastName" 
                    class="form-control me-2"  
                    placeholder="Last Name"
                    [class.is-invalid]="registerForm.get('lastName')?.errors && registerForm.get('lastName')?.touched">
                <div class="invalid-feedback">Your last name must and be 1-50 characters long.</div>
            </div>

            <div>
                <label for="yearOfBirth">Year of Birth</label>
                <input type="number" 
                    formControlName="yearOfBirth" 
                    class="form-control me-2" 
                    placeholder="Year of Birth"
                    [class.is-invalid]="registerForm.get('yearOfBirth')?.errors && registerForm.get('yearOfBirth')?.touched">
                <div class="invalid-feedback">Please enter a valid year.</div>
            </div>

            <label for="gend">Gender</label>
            <br/>
            <select #gend name="genders" id="gender" (change)="genderChanged(gend.value)">
                <option *ngFor="let gender of genders" value="{{gender}}">{{gender}}</option>
            </select>

            <div>
                <label for="password">Password</label>
                <input type="password" 
                    formControlName="password"  
                    class="form-control me-2"  
                    placeholder="Password"
                    [class.is-invalid]="registerForm.get('password')?.errors && registerForm.get('password')?.touched">
                <div class="invalid-feedback" *ngIf="registerForm.get('password')?.hasError('required')">
                    Please enter a password.
                </div>
                <div class="invalid-feedback" *ngIf="registerForm.get('password')?.hasError('minlength')">
                    Passwords must be at least 8 characters long.
                </div>
                <div class="invalid-feedback" *ngIf="registerForm.get('password')?.hasError('maxlength')">
                    Passwords must be at most 20 characters long.
                </div>              
            </div>

            <div>
                <label for="confirmPassword">Confirm Password</label>
                <input type="password" 
                    formControlName="confirmPassword" 
                    class="form-control me-2"  
                    placeholder="Confirm Password"
                    [class.is-invalid]="registerForm.get('confirmPassword')?.errors && registerForm.get('confirmPassword')?.touched">
                    <div class="invalid-feedback" *ngIf="registerForm.get('confirmPassword')?.hasError('required')">
                        Please confirm your password.
                    </div>
                    <div class="invalid-feedback" *ngIf="registerForm.get('confirmPassword')?.hasError('notMatching')">
                        Passwords do not match.
                    </div>
            </div>

            <div class="row" *ngIf="validationErrors">
                <ul class="text-danger">
                    <li *ngFor="let error of validationErrors">
                        {{error}}
                    </li>
                </ul>
            </div>

            <div>
                <button [disabled]="!registerForm.valid" class="btn btn-success mr-2" type="submit" (click)="register()">Sign Up</button>
            </div>
    </form>
</div>
